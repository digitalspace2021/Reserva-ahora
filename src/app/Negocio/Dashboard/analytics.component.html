<app-page-title [heading]="heading" [subheading]="subheading" [icon]="icon"></app-page-title>

<div class="col-12 text-center" *ngIf="currentUser$.negocio.status != 5">
  <mat-slide-toggle (toggleChange)="triggerOperacionNegocio()" [checked]="currentUser$.negocio.status != 4 && currentUser$.negocio.status != 5">
    <span style="font-family:codigeekfont;">
      Operaci√≥n de tu comercio
    </span>
  </mat-slide-toggle>
  <label style="font-size: 8px; color: #d92550;">
    Activa o desactiva tu comercio para recibir o dejar de recibir pedidos
  </label>
</div>


<div class="mb-3">
  <div class="card-header-tab card-header" style="border: none;">
    <div class="row" style="width: 100%;">
      <div class="col-sm-5">
        <label class="mt-2" style="font-size: 12px;position: relative;width:100%;pointer-events: all;margin-bottom: 5px;text-align: left;">
          De fecha:
        </label>
        <div class="input-group">
          <input
            (dateSelect)="cambioFecha(filtros$.de_fecha)"
            class="form-control"
            placeholder="yyyy-mm-dd"
            name="de_fecha"
            [(ngModel)]="filtros$.de_fecha"
            ngbDatepicker
            #d="ngbDatepicker">
          <div class="input-group-append">
            <button class="btn btn-danger calendar" (click)="d.toggle()" type="button">
              <i class="fa text-white fa-calendar pr-1 pl-1"></i>
            </button>
          </div>
        </div>
      </div>
      <div class="col-sm-5">
        <label class="mt-2" style="font-size: 12px;position: relative;width:100%;pointer-events: all;margin-bottom: 5px;text-align: left;">
          Hasta fecha:
        </label>
        <div class="input-group mb-3">
          <input
            (ngModelChange)="cambioFecha(filtros$.hasta_fecha)"
            class="form-control"
            placeholder="yyyy-mm-dd"
            name="hasta_fecha"
            [(ngModel)]="filtros$.hasta_fecha"
            ngbDatepicker
            #d2="ngbDatepicker">
          <div class="input-group-append">
            <button class="btn btn-danger calendar" (click)="d2.toggle()" type="button">
              <i class="fa text-white fa-calendar pr-1 pl-1"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="no-gutters row">
    <div class="col-sm-12 col-lg-12 mt-3">
      <div class="card">
        <div class="p-0 card-body">
          <div class="p-1 slick-slider-sm mx-auto">
            <div class="widget-chart widget-chart2 text-left p-0">
              <div class="widget-chat-wrapper-outer">
                <div class="widget-chart-content widget-chart-content-lg pb-0">
                  <!-- <div class="widget-chart-flex">
                    <div class="widget-title opacity-5 text-muted text-uppercase">
                      {{ 'dashboard.titulo_grafica' | translate }}
                    </div>
                  </div> -->
                  <div class="widget-numbers">
                    <div class="widget-chart-flex">
                      <div>
                        <span class="text-warning">
                          {{ pedidosArray$.length }}
                        </span>
                      </div>
                      <!-- <div class="widget-title ml-2 font-size-lg font-weight-normal text-dark">
                        <span class="opacity-5 text-muted pl-2 pr-1">
                          {{ 'dashboard.subtitulo_grafica' | translate }}
                        </span>
                      </div> -->
                    </div>
                  </div>
                </div>
                <div class="widget-chart-wrapper he-auto opacity-10 m-0">
                  <div class="d-block">
                    <canvas baseChart
                            class="chart"
                            [datasets]="pedidosArrayGrafica_Dataset$"
                            [labels]="labels"
                            [colors]="lineChartColors"
                            [options]="options"
                            [chartType]="'line'"></canvas>
                  </div>
                </div>
              </div>
            </div>
            <!-- <ngx-slick-carousel class="slick-slider slick-dotted" #slickModal="slick-carousel" [config]="slideConfig6">
              <div ngxSlickItem>
                <div class="widget-chart widget-chart2 text-left p-0">
                  <div class="widget-chat-wrapper-outer">
                    <div class="widget-chart-content widget-chart-content-lg pb-0">
                      <div class="widget-chart-flex">
                        <div class="widget-title opacity-5 text-muted text-uppercase">Helpdesk Tickets</div>
                      </div>
                      <div class="widget-numbers">
                        <div class="widget-chart-flex">
                          <div>
                            <span class="text-warning">34</span>
                          </div>
                          <div class="widget-title ml-2 font-size-lg font-weight-normal text-dark">
                            <span class="opacity-5 text-muted pl-2 pr-1">5%</span>
                            increase
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="widget-chart-wrapper he-auto opacity-10 m-0">
                      <div class="d-block">
                        <canvas baseChart
                                class="chart"
                                [datasets]="datasets"
                                [labels]="labels"
                                [colors]="lineChartColors"
                                [options]="options"
                                [chartType]="'line'"></canvas>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div ngxSlickItem>
                <div class="widget-chart widget-chart2 text-left p-0">
                  <div class="widget-chat-wrapper-outer">
                    <div class="widget-chart-content widget-chart-content-lg pb-0">
                      <div class="widget-chart-flex">
                        <div class="widget-title opacity-5 text-muted text-uppercase">New Accounts since 2018</div>
                      </div>
                      <div class="widget-numbers">
                        <div class="widget-chart-flex">
                          <div>
                                                          <span class="opacity-10 text-success pr-2">
                                                              <fa name="angle-up"></fa>
                                                          </span>
                            <span>78</span>
                            <small class="opacity-5 pl-1">%</small>
                          </div>
                          <div class="widget-title ml-2 font-size-lg font-weight-normal text-muted">
                            <span class="text-success pl-2">+14</span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="widget-chart-wrapper he-auto opacity-10 m-0">
                      <div class="d-block">
                        <canvas baseChart
                                class="chart"
                                [datasets]="datasets2"
                                [labels]="labels"
                                [colors]="lineChartColors2"
                                [options]="options"
                                [chartType]="'line'"></canvas>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div ngxSlickItem>
                <div class="widget-chart widget-chart2 text-left p-0">
                  <div class="widget-chat-wrapper-outer">
                    <div class="widget-chart-content widget-chart-content-lg pb-0">
                      <div class="widget-chart-flex">
                        <div class="widget-title opacity-5 text-muted text-uppercase">Last Year Total Sales</div>
                      </div>
                      <div class="widget-numbers">
                        <div class="widget-chart-flex">
                          <div>
                            <small class="opacity-3 pr-1">$</small>
                            <span>629</span>
                            <span class="text-primary pl-3">
                                                              <fa name="angle-down"></fa>
                                                          </span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="widget-chart-wrapper he-auto opacity-10 m-0">
                      <div class="d-block">
                        <canvas baseChart
                                class="chart"
                                [datasets]="datasets3"
                                [labels]="labels"
                                [colors]="lineChartColors3"
                                [options]="options"
                                [chartType]="'line'"></canvas>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ngx-slick-carousel> -->
          </div>

          <h6 class="text-muted text-uppercase font-size-md opacity-5 pl-3 pr-3 pb-1 font-weight-normal">
            Pedidos
          </h6>
          <ul class="list-group list-group-flush">
            <li class="p-3 bg-transparent list-group-item">
              <div class="widget-content p-0">
                <div class="widget-content-outer">
                  <div class="widget-content-wrapper">
                    <div class="widget-content-left">
                      <div class="widget-heading">
                        Ingresos de terceros
                      </div>
                      <!-- <div class="widget-subheading">Last year expenses</div> -->
                    </div>
                    <div class="widget-content-right">
                      <div class="widget-numbers text-success">
                        <small>$</small>
                        {{ profitPedidos$ | number : '1.2-2' }}
                      </div>
                    </div>
                  </div>
                  <div class="widget-progress-wrapper">
                    <div class="progress-bar-sm progress-bar-animated-alt progress">
                      <div class="progress-bar bg-primary" role="progressbar" aria-valuenow="43" aria-valuemin="0"
                           aria-valuemax="100" style="width: 43%;"></div>
                    </div>
                    <div class="progress-sub-label">
                      <div class="sub-label-left">
                        Crecimiento
                      </div>
                      <div class="sub-label-right">100%</div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="text-center d-block p-3">
    <button (click)="exportarXls()" class="mt-3 btn-pill btn-shadow btn-wide fsize-1 btn btn-success btn-lg">
      <span class="mr-2 opacity-7">
          <i class="icon icon-anim-pulse ion-ios-analytics-outline"></i>
      </span>
      <span class="mr-1">
        Descargar pedidos
      </span>
    </button>
  </div>
</div>

<div class="card mb-3">
  <div class="no-gutters row">
    <div class="col-md-12 col-lg-4">
      <ul class="list-group list-group-flush">
        <li class="bg-transparent list-group-item">
          <div class="widget-content p-0">
            <div class="widget-content-outer">
              <div class="widget-content-wrapper">
                <div class="widget-content-left">
                  <div class="widget-heading">
                    Pedidos completados
                  </div>
                  <div class="widget-subheading">
                    Pedidos: {{ pedidosCompletadosArray$.length }}
                  </div>
                </div>
                <div class="widget-content-right">
                  <div class="widget-numbers text-success">
                    <small>$</small>
                    {{ profitPedidosCompletados$ | number : '1.2-2' }}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </li>
        <li class="bg-transparent list-group-item">
          <div class="widget-content p-0">
            <div class="widget-content-outer">
              <div class="widget-content-wrapper">
                <div class="widget-content-left">
                  <div class="widget-heading">
                    Pedidos en curso
                  </div>
                  <div class="widget-subheading">
                    Pedidos: {{ pedidosEnCursoArray$.length }}
                  </div>
                </div>
                <div class="widget-content-right">
                  <div class="widget-numbers text-warning">
                    <small>$</small>
                    {{ profitPedidosEnCurso$ | number : '1.2-2'}}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </li>
      </ul>
    </div>
    <div class="col-md-12 col-lg-4">
      <ul class="list-group list-group-flush">
        <li class="bg-transparent list-group-item">
          <div class="widget-content p-0">
            <div class="widget-content-outer">
              <div class="widget-content-wrapper">
                <div class="widget-content-left">
                  <div class="widget-heading">
                    Pedidos cancelados
                  </div>
                  <div class="widget-subheading">
                    Pedidos: {{ pedidosCanceladosArray$.length }}
                  </div>
                </div>
                <div class="widget-content-right">
                  <div class="widget-numbers text-danger">
                    <small>$</small>
                    {{ profitPedidosCancelados$ | number : '1.2-2' }}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </li>
        <!-- <li class="bg-transparent list-group-item">
          <div class="widget-content p-0">
            <div class="widget-content-outer">
              <div class="widget-content-wrapper">
                <div class="widget-content-left">
                  <div class="widget-heading">Clients</div>
                  <div class="widget-subheading">Total Clients Profit</div>
                </div>
                <div class="widget-content-right">
                  <div class="widget-numbers text-primary">$12.6k</div>
                </div>
              </div>
            </div>
          </div>
        </li> -->
      </ul>
    </div>
  </div>
</div>
